name: bayesdream_rocm
channels:
  - conda-forge
  - bioconda
  - defaults

dependencies:
  # Python version (match cluster setup)
  - python=3.12

  # Core scientific computing
  - numpy>=1.24.0
  - scipy>=1.10.0
  - pandas>=2.0.0
  - scikit-learn>=1.3.0

  # R and Bioconductor packages for preprocessing
  - r-base>=4.0
  - bioconductor-scran>=1.20
  - r-irkernel
  - r-data.table

  # PyTorch with ROCm support (AMD GPUs)
  # NOTE: PyTorch for ROCm must be installed via pip AFTER creating the environment
  # See installation instructions below

  # Visualization
  - matplotlib>=3.7
  - seaborn>=0.12

  # Pip (PyTorch and Pyro will be installed via pip in separate step)
  - pip

  # Data I/O
  - h5py>=3.8.0

  # Performance
  - openblas

  # Jupyter
  - jupyterlab>=4.0
  - ipykernel
  - notebook
  - ipywidgets

# Installation instructions:
# 1. Check your cluster's ROCm version:
#    rocm-smi --version
#    # OR
#    /opt/rocm/bin/rocminfo
#
# 2. Create the environment (without PyTorch):
#    conda env create -f environment_rocm.yml
#
# 3. Activate the environment:
#    conda activate bayesdream_rocm
#
# 4. Install PyTorch with ROCm support via pip:
#    # For ROCm 6.2 (matches cluster setup):
#    pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/rocm6.2
#
#    # For ROCm 6.1:
#    # pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/rocm6.1
#
#    # For ROCm 6.0:
#    # pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/rocm6.0
#
# 5. Install Pyro:
#    pip install pyro-ppl
#
# 6. Verify GPU access:
#    python -c "import torch; print(torch.cuda.is_available())"
#    # Note: PyTorch uses 'cuda' API for both NVIDIA and AMD GPUs
#
# 7. Install bayesDREAM in development mode:
#    cd /path/to/bayesDREAM_forClaude
#    pip install -e .
#
# Use this environment for:
# - HPC clusters with AMD GPUs (MI250X, MI300, etc.)
# - Workstations with AMD GPUs
# - Clusters that have migrated from NVIDIA to AMD
#
# Important notes:
# - PyTorch for ROCm must be installed via pip (conda packages are incomplete)
# - This matches the working pyroenv setup with torch 2.5.1+rocm6.2
# - ROCm support in PyTorch is generally good but not as mature as CUDA
# - For bayesDREAM, basic operations should work fine
# - If you encounter issues, fall back to environment_cpu.yml
